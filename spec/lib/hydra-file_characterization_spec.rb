require 'spec_helper'
require 'hydra-file_characterization'

describe Hydra::FileCharacterization::Characterizer do
  def fixture_file(filename)
    File.expand_path(File.join('../../fixtures', filename), __FILE__)
  end

  let(:fits_path) { `which fits || which fits.sh`.strip }
  subject { Hydra::FileCharacterization::Characterizer.new(filename, fits_path) }

  describe 'validfile' do
    let(:filename) { fixture_file('brendan_behan.jpeg') }
    it '#call' do
      expect(subject.call).to include(%(<identity format="JPEG File Interchange Format" mimetype="image/jpeg"))
    end

  end

  describe 'invalidFile' do
    let(:filename) { fixture_file('nofile.pdf') }
    it "should raise an error if the path does not contain the file" do

      expect {subject.call}.to raise_error(Hydra::FileCharacterization::Characterizer::FileNotFoundError)
    end
  end


end
